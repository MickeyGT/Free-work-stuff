#include<fstream>
#include<cstring>
#include<queue>
#include<algorithm>
#include<string.h>
#include<bitset>
#include<ctime>
#include<set>
#include<cmath>
#include<unordered_map>
#include<iomanip>
#include<map>
#include<stack>
#include<vector>
#include<bitset>
#include<functional>
#include<iostream>
#include<deque>
#include<unordered_set>
#include<queue>
#include<list>
#include<array>
#include<ctype.h>
using namespace std;
string s;
int i, j, nr, n, vsize;
vector<int>v, dp;
vector<string> database;

vector<string> LoadIndex()
{
	vector<string> words;

	ifstream inputFile("file.in");
	for (string line; std::getline(inputFile, line); )
		words.push_back(line);

	return words;
}

void SaveIndex(const vector<string> & words)
{
	ofstream outputFile("file.out");
	for (const auto & word : words)
		outputFile << word << endl;
}

int binarySearch(string s)
{
	auto it = lower_bound(database.begin(), database.end(), s);
	int nr = (it - database.begin()) + 1;
	if (nr<database.size() && *it == s)
		return nr + dp[nr] - 1;
	else
		if (nr <= database.size())
		{
			if (v[nr] != 0)
				return dp[nr] + nr - 2;
			else
				return dp[nr] + nr - 1;
		}
		else
			return dp[vsize] + vsize - 2;
}

void updateArray(string s)
{
	auto it = lower_bound(database.begin(), database.end(), s);
	int nr = (it - database.begin()) + 1;
	if (v[nr] != 0)
	{
		database.insert(database.begin() + (nr-1), s);
		v.insert(v.begin() + nr, v[nr]-1);
		v[nr+1] = 0;
		dp.insert(dp.begin() + nr, dp[nr]);
		for (i = nr; i <= vsize + 1; i++)
			dp[i] = dp[i - 1] + v[i];
		vsize++;
	}
	else
	{
		database.insert(database.begin() + (nr-1), s);
		v.insert(v.begin() + (nr), 0);
		dp.insert(dp.begin() + nr, dp[nr]);	
		vsize++;
	}
}

void prelucrare(vector<string> data)
{
	vector<string>temp;
	int nr = 0;
	vsize = 1;
	for (auto it = data.begin(); it != data.end(); it++)
	{
		if ((*it).size() == 0)
		{
			nr++;
		}
		else
		{
			temp.push_back(*it);
			v[vsize] = nr;
			nr = 0;
			vsize++;
		}
	}
	vsize--;
	database.clear();
	data.clear();
	for (auto it = temp.begin(); it != temp.end(); it++)
		database.push_back(*it);
}
void vectorFinal(vector<string> data)
{
	vector<string>temp;
	for (i = 1; i <= vsize; i++)
	{
		for (j = 1; j <= v[i]; j++)
			temp.push_back(" ");
		temp.push_back(data[i - 1]);
	}
	database.clear();
	for (auto it = temp.begin(); it != temp.end(); it++)
	{
		database.push_back(*it);
	}
}
int main()
{
	v.resize(10000);
	dp.resize(10000);
	database = LoadIndex();
	database.push_back("~~~~~~");
	prelucrare(database);
	for (i = 1; i <= vsize; i++)
		dp[i] = dp[i - 1] + v[i];
	cout << binarySearch("ggg") << '\n'; 
	cout << binarySearch("iii") << '\n'; 
	cout << binarySearch("mmm") << '\n'; 
	cout << binarySearch("nnn") << '\n'; 
	cout << binarySearch("ppp") << '\n'; 
	cout << binarySearch("aac") << '\n';
	cout << binarySearch("llx") << '\n'; 

	updateArray("aax"); 
	updateArray("zza"); 
	updateArray("nnn"); 
	updateArray("aac"); 
	updateArray("ffx"); 
	updateArray("ggx"); 
	database.pop_back();
	vsize--;
	vectorFinal(database);
	SaveIndex(database);
	return 0;
}
//////////////////////////


aaa
bbb

ccc
ddd

eee

fff
ggg
hhh




iii


kkk

lll
mmm

ooo



